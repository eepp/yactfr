trace {
    major = 1;
    minor = 8;
    byte_order = be;
};

event {
    name = test;
    fields := struct {
        enum : u8 {
            X, Y,
        } tag;
        variant <tag> {
            struct {
                u8 len;
                string s;
            } X;
            struct {
                string s;
                u16 len;
            } Y;
        } outer;
        string z;
        string seq[outer.len];
    };
};
----
00
03 "salut" 00
"pad" 00
"un" 00 "deux" 00 "trois" 00

01
"coucou" 00 00 05
"pad" 00
"un" 00 "deux" 00 "trois" 00 "quatre" 00 "cinq" 00
----
     0 P {
     0   PC {
     0     DST:0
     0     ER {
     0       ERT:0:test
     0       SC:5 {
     0         ST {
     0           UE:tag:0
     8           VU:outer:0 {
     8             ST {
     8               UI:len:3
    16               STR:s {
    16                 SS:6:salut
    64               }
    64             }
    64           }
    64           STR:z {
    64             SS:4:pad
    96           }
    96           DA:seq {
    96             STR {
    96               SS:3:un
   120             }
   120             STR {
   120               SS:5:deux
   160             }
   160             STR {
   160               SS:6:trois
   208             }
   208           }
   208         }
   208       }
   208     }
   208     ER {
   208       ERT:0:test
   208       SC:5 {
   208         ST {
   208           UE:tag:1
   216           VU:outer:1 {
   216             ST {
   216               STR:s {
   216                 SS:7:coucou
   272               }
   272               UI:len:5
   288             }
   288           }
   288           STR:z {
   288             SS:4:pad
   320           }
   320           DA:seq {
   320             STR {
   320               SS:3:un
   344             }
   344             STR {
   344               SS:5:deux
   384             }
   384             STR {
   384               SS:6:trois
   432             }
   432             STR {
   432               SS:7:quatre
   488             }
   488             STR {
   488               SS:5:cinq
   528             }
   528           }
   528         }
   528       }
   528     }
   528   }
   528 }
